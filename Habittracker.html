<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HabitHero - Build Better Habits</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #3498db;
            --secondary: #2ecc71;
            --accent: #e74c3c;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --warning: #f39c12;
            --gradient: linear-gradient(135deg, #3498db, #2ecc71);
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Header Styles */
        .header {
            background: var(--gradient);
            padding: 25px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo h1 {
            font-size: 32px;
            font-weight: 800;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .tagline {
            font-style: italic;
            opacity: 0.9;
            font-size: 16px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* Main Content */
        .main-content {
            padding: 30px;
            min-height: 600px;
        }

        /* Page Styles */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Splash Screen */
        .splash {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 600px;
            text-align: center;
            background: var(--gradient);
            color: white;
            padding: 40px;
        }

        .splash h1 {
            font-size: 60px;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .splash .tagline {
            font-size: 24px;
            margin-bottom: 40px;
            opacity: 0.9;
        }

        /* Auth Forms */
        .auth-form {
            max-width: 400px;
            margin: 0 auto;
            padding: 40px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 600;
        }

        .form-control {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn-success {
            background: var(--secondary);
            color: white;
        }

        .btn-danger {
            background: var(--accent);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .link-btn {
            background: none;
            color: var(--primary);
            border: none;
            cursor: pointer;
            font-size: 16px;
            text-decoration: underline;
        }

        .error-message {
            color: var(--accent);
            margin-top: 10px;
            font-size: 14px;
        }

        /* Dashboard */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .welcome-message h2 {
            color: var(--dark);
            font-size: 28px;
            margin-bottom: 5px;
        }

        .motivational-quote {
            font-style: italic;
            color: #7f8c8d;
            padding: 15px;
            background: linear-gradient(135deg, #fdfcfb 0%, #e2d1c3 100%);
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid var(--primary);
        }

        /* Stats Cards */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card i {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .stat-card .value {
            font-size: 36px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .stat-card .label {
            color: #7f8c8d;
            font-size: 14px;
        }

        /* Add Habit Form */
        .add-habit-form {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        /* Habits Grid */
        .habits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .habit-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            position: relative;
            border: 2px solid transparent;
        }

        .habit-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            border-color: var(--primary);
        }

        .habit-card.completed {
            background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
        }

        .habit-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .habit-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .habit-streak {
            background: var(--warning);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }

        .habit-description {
            color: #7f8c8d;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .habit-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn-small {
            padding: 8px 15px;
            font-size: 14px;
        }

        /* Chart Container */
        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }

        /* Success Popup */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }

        .popup {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            animation: popIn 0.3s ease;
        }

        @keyframes popIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .popup-icon {
            font-size: 60px;
            color: var(--secondary);
            margin-bottom: 20px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                border-radius: 10px;
            }
            
            .header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .splash h1 {
                font-size: 40px;
            }
            
            .habits-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div class="splash" id="splashScreen">
        <h1><i class="fas fa-fire"></i> HABITHERO</h1>
        <p class="tagline">Build Better Habits. Become Your Hero.</p>
        <p>Loading your journey to greatness...</p>
    </div>

    <!-- Main Container -->
    <div class="container" id="mainContainer">
        <!-- Header -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-fire fa-2x"></i>
                <div>
                    <h1>HabitHero</h1>
                    <p class="tagline">Build Better Habits. Become Your Hero.</p>
                </div>
            </div>
            <div class="user-info" id="userInfo">
                <!-- Dynamic content -->
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Login Page -->
            <div class="page active" id="loginPage">
                <div class="auth-form">
                    <h2 style="text-align: center; margin-bottom: 30px; color: var(--dark);">
                        Welcome Back Hero!
                    </h2>
                    <div class="form-group">
                        <label for="loginUsername">Username</label>
                        <input type="text" id="loginUsername" class="form-control" placeholder="Enter your username">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" class="form-control" placeholder="Enter your password">
                    </div>
                    <div class="error-message" id="loginError"></div>
                    <button class="btn btn-primary" onclick="login()" style="width: 100%; margin-bottom: 20px;">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <p style="text-align: center;">
                        Don't have an account? 
                        <button class="link-btn" onclick="showPage('registerPage')">Register here</button>
                    </p>
                </div>
            </div>

            <!-- Register Page -->
            <div class="page" id="registerPage">
                <div class="auth-form">
                    <h2 style="text-align: center; margin-bottom: 30px; color: var(--dark);">
                        Join HabitHero!
                    </h2>
                    <div class="form-group">
                        <label for="registerUsername">Username</label>
                        <input type="text" id="registerUsername" class="form-control" placeholder="Choose a username">
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">Password</label>
                        <input type="password" id="registerPassword" class="form-control" placeholder="Enter password (min 6 chars)">
                    </div>
                    <div class="form-group">
                        <label for="registerConfirm">Confirm Password</label>
                        <input type="password" id="registerConfirm" class="form-control" placeholder="Confirm password">
                    </div>
                    <div class="error-message" id="registerError"></div>
                    <button class="btn btn-success" onclick="register()" style="width: 100%; margin-bottom: 20px;">
                        <i class="fas fa-user-plus"></i> Register
                    </button>
                    <p style="text-align: center;">
                        Already have an account? 
                        <button class="link-btn" onclick="showPage('loginPage')">Login here</button>
                    </p>
                </div>
            </div>

            <!-- Dashboard Page -->
            <div class="page" id="dashboardPage">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h2 id="welcomeMessage">Welcome, Hero!</h2>
                        <p>Track your habits and build your streak</p>
                    </div>
                    <button class="btn btn-danger" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>

                <!-- Motivational Quote -->
                <div class="motivational-quote" id="motivationalQuote">
                    Loading quote...
                </div>

                <!-- Stats Cards -->
                <div class="stats-cards">
                    <div class="stat-card">
                        <i class="fas fa-fire" style="color: var(--warning);"></i>
                        <div class="value" id="totalStreak">0</div>
                        <div class="label">Total Streak Days</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-tasks" style="color: var(--primary);"></i>
                        <div class="value" id="totalHabits">0</div>
                        <div class="label">Active Habits</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-calendar-check" style="color: var(--secondary);"></i>
                        <div class="value" id="completedToday">0</div>
                        <div class="label">Completed Today</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-chart-line" style="color: var(--accent);"></i>
                        <div class="value" id="successRate">0%</div>
                        <div class="label">Success Rate</div>
                    </div>
                </div>

                <!-- Add Habit Form -->
                <div class="add-habit-form">
                    <h3 style="margin-bottom: 20px; color: var(--dark);">
                        <i class="fas fa-plus-circle"></i> Add New Habit
                    </h3>
                    <div class="form-row">
                        <div style="flex: 1;">
                            <label>Habit Name</label>
                            <input type="text" id="newHabitName" class="form-control" placeholder="e.g., Morning Exercise">
                        </div>
                        <div style="flex: 1;">
                            <label>Description (Optional)</label>
                            <input type="text" id="newHabitDesc" class="form-control" placeholder="e.g., 30 min workout at 7 AM">
                        </div>
                    </div>
                    <button class="btn btn-success" onclick="addHabit()">
                        <i class="fas fa-plus"></i> Add Habit
                    </button>
                </div>

                <!-- Habits Grid -->
                <h3 style="margin-top: 40px; color: var(--dark);">
                    <i class="fas fa-list-alt"></i> Your Habits
                </h3>
                <div class="habits-grid" id="habitsGrid">
                    <!-- Dynamic habits will be added here -->
                </div>

                <!-- Streak Chart -->
                <div class="chart-container">
                    <h3 style="margin-bottom: 20px; color: var(--dark);">
                        <i class="fas fa-chart-bar"></i> Weekly Progress
                    </h3>
                    <canvas id="streakChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Popup -->
    <div class="popup-overlay" id="successPopup">
        <div class="popup">
            <div class="popup-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h3 id="popupMessage">Success!</h3>
        </div>
    </div>

    <script>
        // Application State
        const state = {
            currentUser: null,
            habits: [],
            quotes: [
                "The secret of getting ahead is getting started.",
                "Small daily improvements lead to stunning results.",
                "Your future self will thank you for today's effort.",
                "Consistency is the key to achieving greatness.",
                "Every habit you build makes you stronger.",
                "Success is the sum of small efforts, repeated day in and day out.",
                "Don't watch the clock; do what it does. Keep going.",
                "The only bad workout is the one that didn't happen."
            ]
        };

        // Simulated Database using localStorage
        class Database {
            static initialize() {
                if (!localStorage.getItem('habithero_users')) {
                    localStorage.setItem('habithero_users', JSON.stringify([]));
                }
                if (!localStorage.getItem('habithero_habits')) {
                    localStorage.setItem('habithero_habits', JSON.stringify([]));
                }
            }

            static registerUser(username, password) {
                const users = JSON.parse(localStorage.getItem('habithero_users'));
                
                // Check if username exists
                if (users.find(u => u.username === username)) {
                    return false;
                }
                
                // Add new user
                const newUser = {
                    id: users.length + 1,
                    username: username,
                    password: password, // In production, hash this!
                    created: new Date().toISOString()
                };
                
                users.push(newUser);
                localStorage.setItem('habithero_users', JSON.stringify(users));
                return true;
            }

            static loginUser(username, password) {
                const users = JSON.parse(localStorage.getItem('habithero_users'));
                return users.find(u => u.username === username && u.password === password);
            }

            static getHabits(userId) {
                const habits = JSON.parse(localStorage.getItem('habithero_habits'));
                return habits.filter(h => h.userId === userId);
            }

            static addHabit(userId, name, description) {
                const habits = JSON.parse(localStorage.getItem('habithero_habits'));
                const newHabit = {
                    id: habits.length + 1,
                    userId: userId,
                    name: name,
                    description: description,
                    createdDate: new Date().toISOString().split('T')[0],
                    streak: 0,
                    lastCompletedDate: null,
                    completedDates: []
                };
                
                habits.push(newHabit);
                localStorage.setItem('habithero_habits', JSON.stringify(habits));
                return newHabit;
            }

            static updateHabitStreak(habitId, userId) {
                const habits = JSON.parse(localStorage.getItem('habithero_habits'));
                const habitIndex = habits.findIndex(h => h.id === habitId && h.userId === userId);
                
                if (habitIndex === -1) return false;
                
                const habit = habits[habitIndex];
                const today = new Date().toISOString().split('T')[0];
                
                // Check if already completed today
                if (habit.completedDates.includes(today)) {
                    return habit;
                }
                
                // Calculate streak
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                const yesterdayStr = yesterday.toISOString().split('T')[0];
                
                if (habit.lastCompletedDate === yesterdayStr) {
                    habit.streak += 1;
                } else if (habit.lastCompletedDate !== today) {
                    habit.streak = 1;
                }
                
                habit.lastCompletedDate = today;
                habit.completedDates.push(today);
                habits[habitIndex] = habit;
                localStorage.setItem('habithero_habits', JSON.stringify(habits));
                return habit;
            }

            static deleteHabit(habitId, userId) {
                let habits = JSON.parse(localStorage.getItem('habithero_habits'));
                habits = habits.filter(h => !(h.id === habitId && h.userId === userId));
                localStorage.setItem('habithero_habits', JSON.stringify(habits));
                return true;
            }
        }

        // UI Functions
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }

        function showSuccess(message) {
            document.getElementById('popupMessage').textContent = message;
            const popup = document.getElementById('successPopup');
            popup.style.display = 'flex';
            setTimeout(() => {
                popup.style.display = 'none';
            }, 2000);
        }

        function getRandomQuote() {
            return state.quotes[Math.floor(Math.random() * state.quotes.length)];
        }

        // Auth Functions
        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            const errorElement = document.getElementById('loginError');
            
            if (!username || !password) {
                errorElement.textContent = 'Please fill in all fields';
                return;
            }
            
            const user = Database.loginUser(username, password);
            if (user) {
                state.currentUser = user;
                document.getElementById('loginUsername').value = '';
                document.getElementById('loginPassword').value = '';
                errorElement.textContent = '';
                loadDashboard();
            } else {
                errorElement.textContent = 'Invalid username or password';
            }
        }

        function register() {
            const username = document.getElementById('registerUsername').value;
            const password = document.getElementById('registerPassword').value;
            const confirm = document.getElementById('registerConfirm').value;
            const errorElement = document.getElementById('registerError');
            
            if (!username || !password || !confirm) {
                errorElement.textContent = 'Please fill in all fields';
                return;
            }
            
            if (password !== confirm) {
                errorElement.textContent = 'Passwords do not match';
                return;
            }
            
            if (password.length < 6) {
                errorElement.textContent = 'Password must be at least 6 characters';
                return;
            }
            
            if (Database.registerUser(username, password)) {
                showSuccess('Registration successful! Please login.');
                showPage('loginPage');
                document.getElementById('registerUsername').value = '';
                document.getElementById('registerPassword').value = '';
                document.getElementById('registerConfirm').value = '';
                errorElement.textContent = '';
            } else {
                errorElement.textContent = 'Username already exists';
            }
        }

        function logout() {
            state.currentUser = null;
            state.habits = [];
            showPage('loginPage');
        }

        // Dashboard Functions
        function loadDashboard() {
            showPage('dashboardPage');
            document.getElementById('welcomeMessage').textContent = `Welcome, ${state.currentUser.username}!`;
            document.getElementById('motivationalQuote').textContent = `"${getRandomQuote()}"`;
            
            // Load user habits
            state.habits = Database.getHabits(state.currentUser.id);
            renderHabits();
            updateStats();
            renderChart();
        }

        function renderHabits() {
            const habitsGrid = document.getElementById('habitsGrid');
            habitsGrid.innerHTML = '';
            
            if (state.habits.length === 0) {
                habitsGrid.innerHTML = `
                    <div style="text-align: center; padding: 40px; grid-column: 1 / -1;">
                        <i class="fas fa-clipboard-list fa-3x" style="color: #ddd; margin-bottom: 20px;"></i>
                        <h3 style="color: #7f8c8d;">No habits yet</h3>
                        <p>Add your first habit using the form above!</p>
                    </div>
                `;
                return;
            }
            
            const today = new Date().toISOString().split('T')[0];
            
            state.habits.forEach(habit => {
                const isCompletedToday = habit.completedDates.includes(today);
                const cardClass = isCompletedToday ? 'habit-card completed' : 'habit-card';
                
                const card = document.createElement('div');
                card.className = cardClass;
                card.innerHTML = `
                    <div class="habit-header">
                        <div>
                            <div class="habit-title">${habit.name}</div>
                            <small>Created: ${habit.createdDate}</small>
                        </div>
                        <div class="habit-streak">${habit.streak} day streak</div>
                    </div>
                    <div class="habit-description">${habit.description || 'No description provided'}</div>
                    <div class="habit-actions">
                        <button class="btn btn-small btn-success" onclick="completeHabit(${habit.id})" 
                                ${isCompletedToday ? 'disabled style="opacity: 0.5;"' : ''}>
                            <i class="fas fa-check"></i> 
                            ${isCompletedToday ? 'Completed Today' : 'Mark Complete'}
                        </button>
                        <button class="btn btn-small btn-danger" onclick="deleteHabit(${habit.id})">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                habitsGrid.appendChild(card);
            });
        }

        function addHabit() {
            const name = document.getElementById('newHabitName').value;
            const desc = document.getElementById('newHabitDesc').value;
            
            if (!name) {
                showSuccess('Please enter a habit name');
                return;
            }
            
            Database.addHabit(state.currentUser.id, name, desc);
            document.getElementById('newHabitName').value = '';
            document.getElementById('newHabitDesc').value = '';
            
            state.habits = Database.getHabits(state.currentUser.id);
            renderHabits();
            updateStats();
            showSuccess(`Habit "${name}" added successfully!`);
        }

        function completeHabit(habitId) {
            const updatedHabit = Database.updateHabitStreak(habitId, state.currentUser.id);
            if (updatedHabit) {
                state.habits = Database.getHabits(state.currentUser.id);
                renderHabits();
                updateStats();
                renderChart();
                showSuccess(`Great job! Streak: ${updatedHabit.streak} days`);
            }
        }

        function deleteHabit(habitId) {
            if (confirm('Are you sure you want to delete this habit?')) {
                Database.deleteHabit(habitId, state.currentUser.id);
                state.habits = Database.getHabits(state.currentUser.id);
                renderHabits();
                updateStats();
                showSuccess('Habit deleted successfully');
            }
        }

        function updateStats() {
            const today = new Date().toISOString().split('T')[0];
            const totalStreak = state.habits.reduce((sum, habit) => sum + habit.streak, 0);
            const completedToday = state.habits.filter(h => h.completedDates.includes(today)).length;
            const successRate = state.habits.length > 0 ? 
                Math.round((completedToday / state.habits.length) * 100) : 0;
            
            document.getElementById('totalStreak').textContent = totalStreak;
            document.getElementById('totalHabits').textContent = state.habits.length;
            document.getElementById('completedToday').textContent = completedToday;
            document.getElementById('successRate').textContent = `${successRate}%`;
        }

        function renderChart() {
            const ctx = document.getElementById('streakChart').getContext('2d');
            const today = new Date();
            const last7Days = [];
            
            // Generate last 7 days
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(today.getDate() - i);
                last7Days.push(date.toISOString().split('T')[0]);
            }
            
            // Calculate completions per day
            const completions = last7Days.map(date => {
                return state.habits.filter(habit => 
                    habit.completedDates.includes(date)
                ).length;
            });
            
            // Destroy previous chart if exists
            if (window.streakChartInstance) {
                window.streakChartInstance.destroy();
            }
            
            window.streakChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: last7Days.map(d => new Date(d).toLocaleDateString('en-US', { weekday: 'short' })),
                    datasets: [{
                        label: 'Habits Completed',
                        data: completions,
                        backgroundColor: 'rgba(52, 152, 219, 0.7)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: state.habits.length,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Initialize Application
        function init() {
            Database.initialize();
            
            // Show splash screen for 2 seconds
            setTimeout(() => {
                document.getElementById('splashScreen').style.display = 'none';
                document.getElementById('mainContainer').style.display = 'block';
                
                // Check if user is already logged in (from localStorage)
                const lastUser = localStorage.getItem('habithero_lastUser');
                if (lastUser) {
                    const user = JSON.parse(lastUser);
                    state.currentUser = user;
                    loadDashboard();
                } else {
                    showPage('loginPage');
                }
            }, 2000);
        }

        // Start the application
        init();
    </script>
</body>
</html>